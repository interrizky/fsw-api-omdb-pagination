<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./assets/plugins/bootstrap/css/bootstrap.css"/>
  <link rel="stylesheet" href="./assets/css/styles.css" />      
</head>
<body>
  <div class="container-fluid">
    <div class="row navbar">
      <div class="logo col-7">
        <a class="text-logo" style="margin-left: 35px; font-weight: bold" href="apix.html">LOGO</a>
      </div>
      <div class="menu col-5 d-flex flex-row-reverse justify-content-center">
        <button type="button" class="btn btn-outline-light">SUBSCRIBE</button>
        <div class="p-2 bd-highlight">ABOUT</div>
        <div class="p-2 bd-highlight">PRODUCT</div>
        <div class="p-2 bd-highlight">ARTICLES</div>
      </div>
    </div>
    
    <div class="row details">
      <div class="wrapper poster-desc col-md-12 p-5 d-flex justify-content-center">
        <div class="poster-image col-md-4 shadow-lg rounded justify-content-center" style="align-content: center; align-items: center; text-align: center">

        </div>
        <div class="teks-deskripsi col-md-8 shadow-lg rounded" style="align-content: center; align-items: center; text-align: left">
          <div class="deskripsi">

          </div>
        </div>
      </div>
    </div>      

    <div class="row related-movie" style="text-align: center;">
      <p class="preambule" style="font-size: 24px;"><i>Movie That You May Like</i></p>
      <div class="wrapper-thumbnail d-flex justify-content-center">

      </div>
    </div>
  </div>
</body>
<script type="text/javascript">
    const urlSearchParams = new URLSearchParams(window.location.search);
    const params = Object.fromEntries(urlSearchParams.entries());  
    console.log(params);
    // console.log(params.id);
    // console.log(params.title);

    fetch('http://www.omdbapi.com/?apikey=54ece844&i='+params.id)
    .then(function (response) {
      return response.json();
    })
    .then(function (result) { 
      /* poster */
      if(result.Poster == "N/A") {
        result.Poster = './assets/images/pngfind-9-transparent.png';
      }

      let images = document.querySelector('.details .poster-image');
      images.insertAdjacentHTML('afterbegin', `
        <img src="${result.Poster}" style="width: 75%;"></img>
      `);
      
      /* text */
      let deskripsi = document.querySelector('.details .teks-deskripsi .deskripsi');
      deskripsi.insertAdjacentHTML('afterbegin',`
        <h5>Plot : <i>${result.Plot}</i></h5>
        <br/>
        <h5>Actors : ${result.Actors}</h5>
        <h5>Director : ${result.Director}</h5>
        <h5>Writer : ${result.Writer}</h5>        
        <br/>
        <h5>Year : ${result.Year}</h5>
        <h5>imdbRatings : ${result.imdbRating}</h5>
        <br/>        
        <h5>Awards : ${result.Awards}</h5>
        <h5>BoxOffice : ${result.BoxOffice}</h5>
        <h5>Country : ${result.Country}</h5>
        <h5>DVD : ${result.DVD}</h5>
        <h5>Genre : ${result.Genre}</h5>
        <br/>
      `);      
    })
    .then(function (data){
      this.data = data;
      fetch('http://www.omdbapi.com/?apikey=54ece844&s='+params.title)
      .then(function(response){
        return response.json();
      })
      .then(function(result){
        let arrayBaru = [];
        arrayBaru = result.Search.slice(0,3)

        for (var j = 0; j < arrayBaru.length; j++) {
          let isiThumb = document.querySelector('.related-movie .wrapper-thumbnail');
          
          if(arrayBaru[j].Poster == "N/A") {
            arrayBaru[j].Poster = './assets/images/pngfind-9-transparent.png';
          }

          isiThumb.insertAdjacentHTML('afterbegin', `
            <div class="thumbnail-${(j+1)} m-4 shadow-lg rounded col-md-3">
              <image class="mb-2" style="width:200px; height:200px;" src='${arrayBaru[j].Poster}''></image>
              <p class="text-wrap"><i>${arrayBaru[j].Title} (${arrayBaru[j].Year})</i></p>
            </div>          
          `);
        }
      })
      .catch(function (error) {
        this.error = error;
        console.log(this.error);
      })     
    })
    .catch(function (error) {
      this.error = error;
      console.log(this.error);
    })
  </script>
</html>